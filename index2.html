<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Belur Mission: The Hoysala Quest</title>
    <style>
        :root { --primary: #667eea; --secondary: #764ba2; --success: #28a745; }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
        body { background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%); min-height: 100vh; padding: 15px; }
        .container { max-width: 700px; margin: 0 auto; background: white; border-radius: 20px; box-shadow: 0 15px 40px rgba(0,0,0,0.3); overflow: hidden; }
        
        .header { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; padding: 25px; text-align: center; }
        .status-bar { position: sticky; top: 0; z-index: 1000; background: #fff3cd; border-bottom: 2px solid #ffeeba; padding: 10px; text-align: center; }
        #rankBanner { font-weight: bold; color: #856404; }
        
        .progress-bg { background: #e9ecef; height: 12px; border-radius: 6px; margin: 8px 20px; overflow: hidden; }
        #progressFill { background: var(--success); height: 100%; width: 0%; transition: 0.5s; }

        .team-info { padding: 20px; background: #f8f9fa; border-bottom: 1px solid #ddd; }
        input { width: 100%; padding: 10px; margin: 5px 0; border: 1px solid #ccc; border-radius: 8px; }

        .zone-title { background: #343a40; color: white; padding: 10px 20px; font-size: 0.9em; text-transform: uppercase; }
        .item { padding: 20px; border-bottom: 1px solid #eee; transition: 0.3s; }
        .item.completed { background: #e8f5e9; }
        
        .item-header { display: flex; align-items: flex-start; gap: 15px; cursor: pointer; }
        .checkbox { width: 28px; height: 28px; border: 2px solid var(--primary); border-radius: 6px; flex-shrink: 0; display: flex; align-items: center; justify-content: center; background: white; }
        .completed .checkbox { background: var(--success); border-color: var(--success); }
        .completed .checkbox::after { content: '‚úì'; color: white; font-weight: bold; }

        .item-text h3 { font-size: 1.1em; color: #333; }
        .hint { font-size: 0.85em; color: #666; font-style: italic; display: block; margin: 4px 0; }

        /* CAMERA SECTION */
        .camera-area { margin-top: 15px; }
        .snap-btn { background: #6c757d; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-size: 0.8em; }
        .photo-preview { width: 100%; height: 150px; background: #eee; border-radius: 10px; margin-top: 10px; border: 2px dashed #ccc; display: flex; align-items: center; justify-content: center; overflow: hidden; }
        .photo-preview img { width: 100%; height: 100%; object-fit: cover; }

        .drive-box { margin: 20px; padding: 20px; background: #e3f2fd; border: 2px dashed #1976d2; border-radius: 15px; text-align: center; }
        .drive-btn { display: inline-block; background: #1976d2; color: white; padding: 12px 24px; text-decoration: none; border-radius: 8px; font-weight: bold; margin-top: 10px; }

        .footer-btns { padding: 20px; display: flex; gap: 10px; }
        .btn { flex: 1; padding: 15px; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; }
        .btn-submit { background: var(--secondary); color: white; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>üèõÔ∏è Belur Quest</h1>
        <p>Official Scavenger Hunt</p>
    </div>

    <div class="status-bar">
        <div id="rankBanner">Rank: Junior Scout</div>
        <div class="progress-bg"><div id="progressFill"></div></div>
    </div>

    <div class="team-info">
        <input type="text" id="teamName" placeholder="Team Name">
        <input type="text" id="teacherName" placeholder="Teacher Name">
    </div>

    <div class="drive-box">
        <p style="color: #1976d2; font-weight: bold;">üì§ Photo Evidence Portal</p>
        <p style="font-size: 0.8em;">Upload your best 5 mimics to the team folder</p>
        <a href="YOUR_GOOGLE_FORM_LINK_HERE" class="drive-btn" target="_blank">Upload to Google Drive</a>
    </div>

    <div id="questList"></div>

    <div class="footer-btns">
        <button class="btn btn-submit" onclick="dispatchReport()">Dispatch Final Report</button>
    </div>
</div>

<script>
    const questData = [
        { zone: "Zone 1: Courtyard & Base", items: [
            { id: 1, title: "The Royal Emblem", hint: "Sala fighting the tiger at the main entrance." },
            { id: 2, title: "Elephant Frieze", hint: "Find the row with 650 unique elephants." },
            { id: 3, title: "The Makara", hint: "The 7-in-1 mythical monster carving." },
            { id: 4, title: "War Horses", hint: "Row 3 of the base; check the riders' boots!" },
            { id: 5, title: "Lion Faces", hint: "Repeating row of fierce guardian faces." }
        ]},
        { zone: "Zone 2: Stone People (Madanikas)", items: [
            { id: 6, title: "Mirror Lady (Photo Challenge)", hint: "Darpana Sundari checking her style." },
            { id: 7, title: "The Monkey Attack", hint: "Madanika annoyed by a small monkey." },
            { id: 8, title: "The Parrot Whisperer", hint: "Lady with a bird perched on her arm." },
            { id: 9, title: "The Huntress", hint: "Lady aiming a stone bow and arrow." },
            { id: 10, title: "The Lizard Secret", hint: "A tiny lizard on a fruit near Item 6." }
        ]},
        { zone: "Zone 3: Interior Hall", items: [
            { id: 11, title: "Mohini Pillar", hint: "Black, polished, mirror-like pillar." },
            { id: 12, title: "Narasimha Pillar", hint: "Reddish pillar with microscopic carvings." },
            { id: 13, title: "The Gravity Pillar", hint: "The stone pillar standing on 3 corners." },
            { id: 14, title: "Lotus Ceiling", hint: "Look straight up in the central hall." },
            { id: 15, title: "Fierce Avatar", hint: "Large panel of Narasimha vs Hiranyakashipu." }
        ]},
        { zone: "Zone 4: Tiny Details", items: [
            { id: 16, title: "Fly on the Corn", hint: "A tiny fly on a stone maize cob." },
            { id: 17, title: "Artist Signature", hint: "Old Kannada names at the base of statues." },
            { id: 18, title: "Skull Necklace", hint: "Found on a spooky guardian figure." },
            { id: 19, title: "The Food Chain", hint: "A panel showing predator vs prey." },
            { id: 20, title: "The Frog Temple", hint: "The Kappe Chennigaraya shrine nearby." }
        ]}
    ];

    let state = JSON.parse(localStorage.getItem('belurMasterState') || '{}');

    function init() {
        const list = document.getElementById('questList');
        list.innerHTML = '';
        
        questData.forEach(section => {
            const zHeader = document.createElement('div');
            zHeader.className = 'zone-title';
            zHeader.innerText = section.zone;
            list.appendChild(zHeader);

            section.items.forEach(item => {
                const isDone = state[`item${item.id}`];
                const photo = state[`photo${item.id}`];
                const div = document.createElement('div');
                div.className = `item ${isDone ? 'completed' : ''}`;
                div.id = `item-box-${item.id}`;
                div.innerHTML = `
                    <div class="item-header" onclick="toggleItem(${item.id})">
                        <div class="checkbox"></div>
                        <div class="item-text">
                            <h3>${item.title}</h3>
                            <span class="hint">üìç ${item.hint}</span>
                        </div>
                    </div>
                    <div class="camera-area">
                        <input type="file" accept="image/*" capture="camera" id="cam-${item.id}" style="display:none" onchange="handlePhoto(event, ${item.id})">
                        <button class="snap-btn" onclick="document.getElementById('cam-${item.id}').click()">üì∏ Photo Challenge</button>
                        <div class="photo-preview" id="prev-${item.id}">
                            ${photo ? `<img src="${photo}">` : '<span>Preview</span>'}
                        </div>
                    </div>
                `;
                list.appendChild(div);
            });
        });
        updateProgress();
    }

    function toggleItem(id) {
        state[`item${id}`] = !state[`item${id}`];
        localStorage.setItem('belurMasterState', JSON.stringify(state));
        document.getElementById(`item-box-${id}`).classList.toggle('completed');
        updateProgress();
    }

    function handlePhoto(event, id) {
        const reader = new FileReader();
        reader.onload = function() {
            state[`photo${id}`] = reader.result;
            localStorage.setItem('belurMasterState', JSON.stringify(state));
            document.getElementById(`prev-${id}`).innerHTML = `<img src="${reader.result}">`;
        }
        reader.readAsDataURL(event.target.files[0]);
    }

    function updateProgress() {
        const done = Object.keys(state).filter(k => k.startsWith('item') && state[k]).length;
        const fill = document.getElementById('progressFill');
        const rank = document.getElementById('rankBanner');
        
        fill.style.width = (done / 20 * 100) + '%';
        
        let title = "Junior Scout";
        if(done >= 20) title = "üèÜ Legend of Belur";
        else if(done >= 15) title = "Royal Historian";
        else if(done >= 10) title = "Expert Explorer";
        else if(done >= 5) title = "Senior Scout";
        rank.innerText = `Rank: ${title} (${done}/20)`;
    }

    function dispatchReport() {
        const team = document.getElementById('teamName').value || 'Unknown';
        const done = Object.keys(state).filter(k => k.startsWith('item') && state[k]).length;
        const text = `Mission Complete! Team: ${team}. Rank: ${document.getElementById('rankBanner').innerText}. Score: ${done}/20. Check our Drive for photos!`;
        navigator.share ? navigator.share({text: text}) : alert(text);
    }

    document.getElementById('teamName').value = state.teamName || '';
    document.getElementById('teamName').oninput = (e) => { state.teamName = e.target.value; localStorage.setItem('belurMasterState', JSON.stringify(state)); };

    init();
</script>
</body>
</html>
